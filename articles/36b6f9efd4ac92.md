---
title: "Zenn of Nimの翻訳"
emoji: "👑"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

この記事では2021年11月15日に発表されたZen of Nimの翻訳をします。
PythonにもZen of Pythonという思想があり、それがプログラミング言語自体のデザインの指針となっていますが、Nimでもデザインのための思想があります。
ここからNimという言語のデザイン思想について触れていただければと思います。

https://nim-lang.org/blog/2021/11/15/zen-of-nim.html

## Zen of Nim
1. 悪いデザインをコピーすることは良いデザインではありません。
2. もしコンパイラがコードを理解することができなければ、プログラマーもそのコードを理解することはできません。
3. プログラマーの邪魔をしてはいけません。
4. コンパイル時に多くのことをしよう：プログラムはコンパイル時よりも実行時により多く動くからである。
5. カスタマイズできるメモリ管理。
6. 簡潔なコードは読みやすさと相反するものではなく、より読みやすくさせるものである。（メタプログラミングを活用して言語機能を小さくしよう）
7. 最適化とは特化することです。もっとスピードが必要なときは、カスタムコードを書けばよい。
8. プログラミング言語はたった一つであるべきで、その一つでどんな開発でもできるべきであるーそれがNimです。

> 編集者注
> 
> オリジナルのプレゼンテーションでは、Zen of Nimは最後に（そして番号も付けずに）説明されていました。ここでは、Zen of Nimのルールを一番最初に提供し、参照しやすいように番号を振っています。上記のルールの議論は言語の一般的な議論の文脈で行われ、この順序に沿った説明はしません。ここでは、内容はオリジナルのプレゼンテーションに従って、最小限の編集でスライド資料とビデオの文字起こしを元にしています（そのためカジュアルなトーンになっています）。

## はじめに
このブログでは、Nim言語の哲学と、なぜNimが以下のような幅広いアプリケーションドメインに有用であるかを説明します。
- 科学技術計算
- ゲーム
- コンパイラ
- OS開発
- スクリプティング
- その他様々

"Zen"とは、上記のような一連の指針に到達するための言語設計と進化のルールを意味しますが、このルールをサンプルコードによって説明します。

## 構文
Nimをその構文を通して紹介しましょう。ほとんどの方はこの言語をご存知だと思いますが、初めて見る方にも優しく紹介するために、基本的な構文を説明し、できれば面白いと感じてもらえるようにしたいと思います。

Nim では、Haskell や Python にヒントを得た**インデントベースの構文**を採用しており、**Nimのマクロシステムにも適合**しています。

以下はシンタックスシュガーです。

||書き方|意味|例|
|---|---|---|---|
|1|f a|f(a)|`spawn log("some message")`|
|2|f a, b|f(a, b)|`echo "hello ", "world"`|
|3|a.f()|f(a)|`db.fetchRow()`|
|4|a.f|f(a)|`	mystring.len`|
|5|a.f(b)|f(a, b)|`myarray.map(f)`|
|6|a.f b|f(a, b)|`db.fetchRow 1`|
|7|f"\n"|f(r"\n")|`	re"\b[a-z*]\b"`|
|8|f a: b|f(a, b)|`lock x: echo "hi"`|

- ルール1と2では括弧を省略することができ、この例によってなぜそれが便利なのかが分かると思います。spawnはキーワードのように見えますが、特別なことをすることを意味しているので良いのです。echoもまた括弧を省くことで有名ですが、これは通常デバッグのために使われるので、最も簡潔に書きたいはずです。
- ドット表記が使えるので、括弧を省くことができます（ルール3～6）。
- ルール7は文字列リテラルについてです。fの後に空白を含まない文字列を続けても関数呼び出しですが、正規表現ではバックスラッシュに意味があるため、非常に扱うのが便利な生の文字列リテラルに変換されます。
- 最後に、`:`構文を使ってコードブロックを関数fに渡すことができることを確認します。コードブロックは通常、関数に渡す最後の引数になります。これは、カスタムロックステートメントを作成するために使うことができます。

括弧を省くことには1つ例外があります。例えば、fを直接参照したい場合です。`f`は`f()`を意味するものではありません。`myarray.map(f)`の場合、fを呼び出すのではなく、f自身をmapに渡したいのです。

## 演算子
Nimには二項演算子と単項演算子があります。
- ほとんどの場合、二項演算子は`x @ y`、単項演算子は`@x`と簡単に呼び出されます。
- 演算子と関数、二項演算子と単項演算子の明確な区別はありません。

```nim
func `++`(x: var int; y: int = 1; z: int = 0) =
  x = x + y + z

var g = 70
++g
g ++ 7
# 演算子のバッククォートは関数と同じように扱われます:
g.`++`(10, 20)
echo g  # 108を出力
```

- 演算子は単に関数のシンタックスシュガーです。
- 関数が定義されると演算子はバッククォートの中に入り（例：++）、バッククォートの表記で関数として呼び出すことができます。

`var`キーワードはミュータビリティを示します。
- パラメータは、var として宣言されていない限り、読み取り専用です。
- varは「参照渡し」の意味です（隠しポインタとして実装されています）。

## ステートメント（文）とエクスプレッション（式）
ステートメントにはインデントが必要です。

```nim
# 単一の代入文ではインデントは必要ありません:
if x: x = false

# 入れ子になったif文にはインデントが必要です:
if x:
  if y:
    y = false
else:
  y = true

# 条件の後に2つの文が続くので
# インデントが必要です
if x:
  x = false
  y = false
```

改行の代わりにセミコロンを使うこともできますが、Nimではこれはめったに使いません。

式は実際にはインデントに基づいていないので、式の中で追加の空白を自由に使うことができます。
```nim
if thisIsaLongCondition() and
    thisIsAnotherLongCondition(1,
        2, 3, 4):
  x = true
```